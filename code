import boto3

# Initialize Boto3 Trusted Advisor client (AWS Support API)
client = boto3.client('support', region_name='us-east-1')

# List all Trusted Advisor checks
checks = client.describe_trusted_advisor_checks(language='en')

# Loop through all the checks and get detailed results for each
for check in checks['checks']:
    check_id = check['id']
    check_name = check['name']
    print(f"Fetching details for Check ID: {check_id}, Name: {check_name}")
    
    # Get the detailed result for each check
    check_result = client.describe_trusted_advisor_check_result(checkId=check_id)
    
    # Print the detailed result for the check
    result = check_result['result']
    print(f"Status: {result['status']}")
    print(f"Flagged Resources: {result['resourcesSummary']['resourcesFlagged']}")
    
    for resource in result['flaggedResources']:
        print(f"Resource ID: {resource['resourceId']}, Status: {resource['status']}")
        # Print metadata fields for each flagged resource
        print(f"Metadata: {resource['metadata']}")
    print("\n")  # Add a new line for better readability between checks
