function listGoogleTasks() {
  // Clear the existing data in the sheet
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  sheet.clear();

  // Set headers in the sheet
  sheet.appendRow(['Task Name', 'Description', 'Due Date', 'Status']);

  // Get the list of task lists in Google Tasks
  var taskLists = Tasks.Tasklists.list().items;

  if (!taskLists || taskLists.length === 0) {
    Logger.log('No task lists found.');
    return;
  }

  // Loop through each task list
  for (var i = 0; i < taskLists.length; i++) {
    var taskListId = taskLists[i].id;
    var taskListName = taskLists[i].title;

    // Get the tasks in the current task list
    var tasks = Tasks.Tasks.list(taskListId).items;

    if (!tasks || tasks.length === 0) {
      Logger.log('No tasks found in task list: ' + taskListName);
      continue;
    }

    // Loop through each task and add it to the sheet
    for (var j = 0; j < tasks.length; j++) {
      var task = tasks[j];
      var taskName = task.title;
      var description = task.notes || '';
      var dueDate = task.due ? new Date(task.due).toLocaleDateString() : 'No Due Date';
      var status = task.status === 'completed' ? 'Completed' : 'Not Completed';

      sheet.appendRow([taskName, description, dueDate, status]);
    }
  }
}

function onOpen() {
  var ui = SpreadsheetApp.getUi();
  ui.createMenu('Task List')
    .addItem('List Google Tasks', 'listGoogleTasks')
    .addToUi();
}
